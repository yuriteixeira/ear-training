(this["webpackJsonpear-training"]=this["webpackJsonpear-training"]||[]).push([[0],{10:function(e,t,n){e.exports=n(18)},15:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),l=n(8),i=n.n(l),s=(n(15),n(1)),c=n.n(s),u=n(2),d=n(3),m=n(6),v=(n(17),n(9)),E={MAJOR:[2,2,1,2,2,2,1]};function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e+12*t}function f(){var e=new AudioContext,t=e.createOscillator();t.type="triangle",t.connect(e.destination),t.start(0),a={context:e,oscilator:t}}function g(){var e=function(){var e=b(1)?1:-1,t=b(1)*e;return{note:h(b(11),t),octave:t}}();return{tonic:e,interval:function(e){var t=b(1)?1:-1,n=b(1)*t,a=b(7),r=h(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.MAJOR,a=e-1;if(a<0)return t;var r=n.reduce((function(e,t,n){return n>a?e:e+t}),0);return t+r}(a,e.note),n);return r===e.note&&(a=0),{number:a,note:r,octave:n}}(e)}}function b(e){return Math.floor(Math.random()*Math.floor(e+1))}function p(e){return w.apply(this,arguments)}function w(){return(w=Object(d.a)(c.a.mark((function e(t){var n,a,r,o=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:750,a=t.tonic,r=t.interval,e.next=4,H(a.note,n);case 4:return e.next=6,H(r.note,n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){if(!a.context||!a.oscilator)throw new Error("Audio engine not initialised.");var n=function(e){return Number((440*Math.pow(2,e/12)).toFixed(2))}(e);return a.oscilator.frequency.setTargetAtTime(n,a.context.currentTime,0),new Promise((function(e){a.context.resume(),setTimeout((function(){a.context.suspend(),e()}),t)}))}function C(e){var t,n,a,r={totalQuestions:0,totalIncorrect:0,totalCorrect:0,sumTimeToHit:0,date:e.start,totalTime:e.end-e.start};if(console.debug({game:e}),e.questions.length<1)return r;var o,l=e.questions.reverse(),i=JSON.parse(localStorage.getItem("stats"))||[],s=(o=i,console.debug({historical:o}),o.reduce((function(e,t){var n,a;return t.avgHit.time>(null===(n=e.avgHit)||void 0===n?void 0:n.time)&&(e.avgHit=t.avgHit),t.fasterHit.time>(null===(a=e.fasterHit)||void 0===a?void 0:a.time)&&(e.fasterHit=t.fasterHit),e}),{})),c=l.reduce((function(e,t){if(e.totalQuestions++,t.choice!==t.interval.number)return e.totalIncorrect++,e;e.totalCorrect++;var n=t.end-t.start;e.sumTimeToHit=e.sumTimeToHit+n;var a=e.fasterHit&&e.fasterHit.end-e.fasterHit.start,r=e.fasterHit&&e.slowerHit.end-e.slowerHit.start;return(!a||n<a)&&(e.fasterHit=Object(u.a)({},t,{time:n})),(!r||n>r)&&(e.slowerHit=Object(u.a)({},t,{time:n})),e}),r);return c.avgHit={time:c.totalCorrect&&c.sumTimeToHit/c.totalCorrect},localStorage.setItem("stats",JSON.stringify([].concat(Object(v.a)(i),[c]))),console.debug({gameStats:c}),c.fasterHit.isRecord=c.fasterHit.time<(null===(t=s.fasterHit)||void 0===t?void 0:t.time),c.fasterHit.lastRecord=s.fasterHit,c.slowerHit.isRecord=c.slowerHit.time<(null===(n=s.slowerHit)||void 0===n?void 0:n.time),c.slowerHit.lastRecord=s.slowerHit,c.avgHit.isRecord=c.avgHit.time<(null===(a=s.avgHit)||void 0===a?void 0:a.time),c}function R(e){if(!e)return"???";var t=(e/1e3).toFixed(2);return"".concat(t,"s")}function y(e,t){return q.apply(this,arguments)}function q(){return(q=Object(d.a)(c.a.mark((function e(t,n){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g(),t.questions.unshift(a),n(Object(u.a)({},t)),e.next=5,p(t.questions[0]);case 5:t.questions[0].hasPlayed=!0,t.questions[0].start=Date.now(),n(Object(u.a)({},t));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O,T=function(e){var t=e.start;return o.a.createElement("section",{className:"start"},o.a.createElement("header",null,"Ear Trainer \ud83c\udfbc"),o.a.createElement("button",{onClick:t},"Press to START!"))},k=function(e){var t=e.answer,n=e.question,a=e.skipQuestion,r=e.end;return o.a.createElement("section",{className:"question"},o.a.createElement("header",null,"What is the interval?"),o.a.createElement("section",{className:"choice"},o.a.createElement("button",{value:0,onClick:t,disabled:!n.hasPlayed},"1"),o.a.createElement("button",{value:1,onClick:t,disabled:!n.hasPlayed},"2"),o.a.createElement("button",{value:2,onClick:t,disabled:!n.hasPlayed},"3"),o.a.createElement("button",{value:3,onClick:t,disabled:!n.hasPlayed},"4"),o.a.createElement("button",{value:4,onClick:t,disabled:!n.hasPlayed},"5"),o.a.createElement("button",{value:5,onClick:t,disabled:!n.hasPlayed},"6"),o.a.createElement("button",{value:6,onClick:t,disabled:!n.hasPlayed},"7"),o.a.createElement("button",{value:7,onClick:t,disabled:!n.hasPlayed},"8")),o.a.createElement("section",{className:"other-actions"},o.a.createElement("button",{onClick:function(){return p(n)},disabled:!n.hasPlayed},"Re-play"),o.a.createElement("button",{onClick:a,disabled:!n.hasPlayed},"Next!"),o.a.createElement("button",{onClick:r,disabled:!n.hasPlayed},"Enough! Show how well I did")))},S=function(e){var t=e.isChoiceCorrect,n=e.question,a=e.end;return o.a.createElement("section",{className:"choice-feedback"},o.a.createElement("p",null,t?"CORRECT! \ud83c\udf89":"Incorrect... \ud83d\ude28"),!t&&o.a.createElement("p",null,"You chose ",n.choice+1," but the write interval is"," ",o.a.createElement("strong",null,n.interval.number+1)),o.a.createElement("p",null,o.a.createElement("strong",null,"But what about this one?")),o.a.createElement("p",null,o.a.createElement("button",{onClick:function(){return a(!1)}},"No more questions, show me stats")))},x=function(e){var t,n,a,r,l,i,s,c,u,d,m,v,E,h,f,g=e.stats;e.historicalStats;return o.a.createElement("section",{className:"end"},o.a.createElement("div",{className:"stats"},g.totalQuestions>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement("table",null,o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("strong",null,"Total questions")),o.a.createElement("td",null,g.totalQuestions)),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("strong",null,"Correct")),o.a.createElement("td",null,g.totalCorrect)),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("strong",null,"Incorrect")),o.a.createElement("td",null,g.totalIncorrect)),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("strong",null,"Faster hit")),o.a.createElement("td",null,R(null===(t=g.fasterHit)||void 0===t?void 0:t.time)," ",g.fasterHit.isRecord?o.a.createElement("strong",null," RECORD!"):o.a.createElement("span",null,"(Last record: ",(null===(n=g.fasterHit)||void 0===n||null===(a=n.lastRecord)||void 0===a?void 0:a.time)||"???"," ","at ",String(new Date(null===(r=g.fasterHit)||void 0===r||null===(l=r.lastRecord)||void 0===l?void 0:l.start)),")"))),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("strong",null,"Slower hit")),o.a.createElement("td",null,R(null===(i=g.slowerHit)||void 0===i?void 0:i.time)," ",g.slowerHit.isRecord?o.a.createElement("strong",null," RECORD!"):o.a.createElement("span",null,"(Last record: ",(null===(s=g.slowerHit)||void 0===s||null===(c=s.lastRecord)||void 0===c?void 0:c.time)||"???"," ","at ",String(new Date(null===(u=g.slowerHit)||void 0===u||null===(d=u.lastRecord)||void 0===d?void 0:d.start)),")"))),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("strong",null,"Avg time to hit")),o.a.createElement("td",null,R(null===(m=g.avgHit)||void 0===m?void 0:m.time)," ",g.avgHit.isRecord?o.a.createElement("strong",null," RECORD!"):o.a.createElement("span",null,"(Last record: ",(null===(v=g.avgHit)||void 0===v||null===(E=v.lastRecord)||void 0===E?void 0:E.time)||"???"," at"," ",String(new Date(null===(h=g.avgHit)||void 0===h||null===(f=h.lastRecord)||void 0===f?void 0:f.start)),")"))),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("strong",null,"Total elapsed time")),o.a.createElement("td",null,R(g.totalTime))))))))};var N=function(){var e=Object(r.useState)({}),t=Object(m.a)(e,2),n=t[0],a=t[1],l=Object(r.useState)({}),i=Object(m.a)(l,2),s=i[0],v=i[1],E=function(e){var t,n=!!e.start,a=!!e.end,r=e.questions,o=r&&r.length>0?r[0]:void 0,l=null===o||void 0===o?void 0:o.choice;return{hasGameStarted:n,hasGameEnded:a,questions:r,question:o,hasMadeChoice:void 0!==l,isChoiceCorrect:l===(null===o||void 0===o||null===(t=o.interval)||void 0===t?void 0:t.number)}}(n);console.debug(n.questions&&n.questions.length>0&&n.questions[0]);var h=E.hasGameStarted,g=E.hasGameEnded,b=E.question,p=E.hasMadeChoice,w=E.isChoiceCorrect;function H(){return{start:Date.now(),questions:[],end:void 0}}function R(){return q.apply(this,arguments)}function q(){return(q=Object(d.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(),t=H(),e.next=4,y(t,a);case 4:console.debug("START");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return j.apply(this,arguments)}function j(){return(j=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(n,a);case 2:console.debug("SKIP QUESTION");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){n.questions[0].choice=Number(e.target.value),n.questions[0].end=Date.now(),a(Object(u.a)({},n)),O=setTimeout(N,3e3),console.debug("ANSWER")}function D(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.end=Date.now(),e?n.questions.shift():clearTimeout(O);var t=C(n);v(t),n.start=void 0,a(Object(u.a)({},n)),console.debug("END")}return o.a.createElement("div",{className:"app"},!h&&o.a.createElement(T,{start:R}),h&&!p&&o.a.createElement(k,{answer:P,question:b,nextQuestion:N,end:D}),h&&p&&o.a.createElement(S,{isChoiceCorrect:w,question:b,end:D}),g&&o.a.createElement(x,{stats:s}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.dca5c972.chunk.js.map