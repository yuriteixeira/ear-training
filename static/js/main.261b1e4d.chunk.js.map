{"version":3,"sources":["engine.js","synth.js","StartHeader.jsx","App.jsx","QuestionsForm.jsx","ChoiceFeedback.jsx","EndFeedbackWithStats.jsx","serviceWorker.js","index.js"],"names":["audio","Synth","this","context","window","AudioContext","webkitAudioContext","oscillator","createOscillator","gainNode","createGain","connect","destination","value","init","frequency","setValueAtTime","currentTime","gain","start","stop","SCALES","MAJOR","transposedNote","note","octaveFromCentral","noteInHertz","Number","Math","pow","toFixed","initEngine","createIntervalQuestion","tonic","direction","randomNumber","octave","createTonic","interval","number","scale","target","intervalSum","reduce","sum","jumps","idx","intervalNote","createInterval","max","floor","random","playIntervalQuestion","intervalQuestion","a","timePerNote","playNote","time","play","Promise","resolve","setTimeout","collectStats","game","defaults","totalQuestions","totalIncorrect","totalCorrect","sumTimeToHit","date","totalTime","end","questions","length","stats","reverse","savedStats","JSON","parse","localStorage","getItem","historicalStats","console","debug","historical","acc","stat","avgHit","fasterHit","gameStats","question","choice","slowerHit","setItem","stringify","isRecord","lastRecord","formatTime","ms","seconds","addQuestion","setGameState","newQuestion","unshift","hasPlayed","Date","now","nextQuestionTimeout","StartHeader","className","onClick","QuestionsForm","answer","nextQuestion","disabled","ChoiceFeedback","isChoiceCorrect","EndFeedbackWithStats","String","App","useState","setStatsState","gameProps","hasGameStarted","hasGameEnded","undefined","hasMadeChoice","getGameProps","resetGame","newGame","element","isDuringQuestion","shift","clearTimeout","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.261b1e4d.chunk.js","sourcesContent":["/*\n * References:\n * - https://medium.com/swinginc/playing-with-midi-in-javascript-b6999f2913c3\n * - https://calculla.com/calculators/table/note_frequencies\n */\n\nimport {Synth} from \"./synth\";\n\nlet audio;\n\nexport const NOTES = {\n  A: 0,\n  Bb: 1,\n  B: 2,\n  C: 3,\n  Db: 4,\n  D: 5,\n  Eb: 6,\n  E: 7,\n  F: 8,\n  Gb: 9,\n  G: 10,\n  Ab: 11,\n};\n\nexport const SCALES = {\n  MAJOR: [2, 2, 1, 2, 2, 2, 1],\n};\n\nexport function transposedNote(note, octaveFromCentral = 0) {\n  return note + octaveFromCentral * 12;\n}\n\nexport function intervalNote(interval, note, scale = SCALES.MAJOR) {\n  // 0 based index - interval ones is internally 0\n  const target = interval - 1;\n\n  // since 0 is the 1st interval, it means it's the same note\n  if (target < 0) return note;\n\n  // find the note given an interval, based in how many steps/jumps are necessary\n  const intervalSum = scale.reduce(\n    (sum, jumps, idx) => (idx > target ? sum : sum + jumps),\n    0\n  );\n  return note + intervalSum;\n}\n\nexport function noteInHertz(note) {\n  return Number((Math.pow(2, note / 12) * 440).toFixed(2));\n}\n\nexport function initEngine() {\n  audio = new Synth();\n}\n\nexport function createIntervalQuestion() {\n  const createTonic = () => {\n    const direction = !!randomNumber(1) ? 1 : -1;\n    const octave = randomNumber(1) * direction;\n    const noteNumber = randomNumber(11); // 12 possible notes\n    const note = transposedNote(noteNumber, octave);\n    return {note, octave};\n  };\n\n  const createInterval = (tonic) => {\n    const direction = !!randomNumber(1) ? 1 : -1;\n    const octave = randomNumber(1) * direction;\n    let number = randomNumber(7); // 8 possible intervals to go from one octave to another\n    const note = transposedNote(intervalNote(number, tonic.note), octave);\n\n    // In case the frequency is the same after transposing, the interval should be the same\n    if (note === tonic.note) {\n      number = 0;\n    }\n\n    return {number, note, octave};\n  };\n\n  const tonic = createTonic();\n  const interval = createInterval(tonic);\n  return {tonic, interval};\n}\n\nfunction randomNumber(max) {\n  return Math.floor(Math.random() * Math.floor(max + 1));\n}\n\nexport async function playIntervalQuestion(\n  intervalQuestion,\n  timePerNote = 750\n) {\n  const {tonic, interval} = intervalQuestion;\n  await playNote(tonic.note, timePerNote);\n  await playNote(interval.note, timePerNote);\n}\n\nasync function playNote(note, time) {\n  audio.play(noteInHertz(note));\n\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      audio.stop();\n      resolve();\n    }, time);\n  });\n}\n\n// TODO: Tests on all new functions below\n\nexport function collectStats(game) {\n  const defaults = {\n    totalQuestions: 0,\n    totalIncorrect: 0,\n    totalCorrect: 0,\n    sumTimeToHit: 0,\n    date: game.start,\n    totalTime: game.end - game.start,\n  };\n\n  if (game.questions.length < 1) return defaults;\n\n  // We need to revert the array before collecting stats (we\n  // stacked items on top, so we could easily access the last\n  // inserted question through index 0)\n  const questions = game.questions.reverse();\n\n  const savedStats = JSON.parse(localStorage.getItem(\"stats\")) || [];\n\n  const historicalStats = collectHistoricalStats(savedStats);\n\n  const gameStats = questions.reduce((acc, question) => {\n    acc.totalQuestions++;\n\n    if (question.choice !== question.interval.number) {\n      acc.totalIncorrect++;\n      return acc;\n    }\n\n    acc.totalCorrect++;\n\n    const time = question.end - question.start;\n    acc.sumTimeToHit = acc.sumTimeToHit + time;\n\n    const fasterHit = acc.fasterHit && acc.fasterHit.end - acc.fasterHit.start;\n    const slowerHit = acc.fasterHit && acc.slowerHit.end - acc.slowerHit.start;\n\n    if (!fasterHit || time < fasterHit) acc.fasterHit = {...question, time};\n\n    if (!slowerHit || time > slowerHit) acc.slowerHit = {...question, time};\n\n    return acc;\n  }, defaults);\n\n  gameStats.avgHit = {\n    time:\n      gameStats.totalCorrect && gameStats.sumTimeToHit / gameStats.totalCorrect,\n  };\n  localStorage.setItem(\"stats\", JSON.stringify([...savedStats, gameStats]));\n\n  // Decorate with historical records\n  console.debug({gameStats});\n  gameStats.fasterHit.isRecord =\n    gameStats.fasterHit.time < historicalStats.fasterHit?.time;\n  gameStats.fasterHit.lastRecord = historicalStats.fasterHit;\n  gameStats.slowerHit.isRecord =\n    gameStats.slowerHit.time < historicalStats.slowerHit?.time;\n  gameStats.slowerHit.lastRecord = historicalStats.slowerHit;\n  gameStats.avgHit.isRecord =\n    gameStats.avgHit.time < historicalStats.avgHit?.time;\n\n  return gameStats;\n}\n\nfunction collectHistoricalStats(stats) {\n  console.debug({historical: stats});\n  return stats.reduce((acc, stat) => {\n    if (stat.avgHit.time > acc.avgHit?.time) acc.avgHit = stat.avgHit;\n    if (stat.fasterHit.time > acc.fasterHit?.time)\n      acc.fasterHit = stat.fasterHit;\n    return acc;\n  }, {});\n}\n\nexport function formatTime(ms) {\n  if (!ms) return \"???\";\n  const seconds = (ms / 1000).toFixed(2);\n  return `${seconds}s`;\n}\n\nexport function getGameProps(game) {\n  const hasGameStarted = !!game.start;\n  const hasGameEnded = !!game.end;\n\n  const questions = game.questions;\n  const question = questions && questions.length > 0 ? questions[0] : undefined;\n  const choice = question?.choice;\n  const hasMadeChoice = choice !== undefined;\n  const isChoiceCorrect = choice === question?.interval?.number;\n  return {\n    hasGameStarted,\n    hasGameEnded,\n    questions,\n    question,\n    hasMadeChoice,\n    isChoiceCorrect,\n  };\n}\n\nexport async function addQuestion(game, setGameState) {\n  const newQuestion = createIntervalQuestion();\n  game.questions.unshift(newQuestion);\n  setGameState({...game});\n\n  await playIntervalQuestion(game.questions[0]);\n\n  game.questions[0].hasPlayed = true;\n  game.questions[0].start = Date.now();\n  setGameState({...game});\n}\n","export class Synth {\n  constructor() {\n    this.context = new (window.AudioContext || window.webkitAudioContext)();\n  }\n\n  init() {\n    this.oscillator = this.context.createOscillator();\n    this.gainNode = this.context.createGain();\n\n    this.oscillator.connect(this.gainNode);\n    this.gainNode.connect(this.context.destination);\n  }\n\n  play(value) {\n    this.init();\n\n    this.oscillator.frequency.setValueAtTime(value, this.context.currentTime);\n    this.gainNode.gain.setValueAtTime(1, this.context.currentTime);\n\n    this.oscillator.start();\n  }\n\n  stop() {\n    this.gainNode.gain.setValueAtTime(0, this.context.currentTime);\n    this.oscillator.stop(this.context.currentTime + 1);\n  }\n}\n","import React from 'react';\n\nexport const StartHeader = ({start}) => (\n  <section className=\"start\">\n    {/* eslint-disable-next-line */}\n    <header>Ear Trainer 🎼</header>\n    <button onClick={start}>Press to START!</button>\n  </section>\n);\n","import React, { useState } from \"react\";\nimport \"./App.css\";\nimport {\n  addQuestion,\n  collectStats,\n  getGameProps,\n  initEngine,\n} from \"./engine.js\";\nimport { StartHeader } from \"./StartHeader\";\nimport { QuestionsForm } from \"./QuestionsForm\";\nimport { ChoiceFeedback } from \"./ChoiceFeedback\";\nimport { EndFeedbackWithStats } from \"./EndFeedbackWithStats\";\n\nlet nextQuestionTimeout;\n\nfunction App() {\n  const [game, setGameState] = useState({});\n  const [stats, setStatsState] = useState({});\n  const gameProps = getGameProps(game);\n\n  const {\n    hasGameStarted,\n    hasGameEnded,\n    question,\n    hasMadeChoice,\n    isChoiceCorrect,\n  } = gameProps;\n\n  function render() {\n    return (\n      <div className=\"app\">\n        {!hasGameStarted && <StartHeader {...{ start }} />}\n\n        {hasGameStarted && !hasMadeChoice && (\n          <QuestionsForm {...{ answer, question, nextQuestion, end }} />\n        )}\n\n        {hasGameStarted && hasMadeChoice && (\n          <ChoiceFeedback {...{ isChoiceCorrect, question, end }} />\n        )}\n\n        {hasGameEnded && <EndFeedbackWithStats {...{ stats }} />}\n      </div>\n    );\n  }\n\n  function resetGame() {\n    return {\n      start: Date.now(),\n      questions: [],\n      end: undefined,\n    };\n  }\n\n  async function start() {\n    initEngine();\n    const newGame = resetGame();\n    await addQuestion(newGame, setGameState);\n\n    console.debug(\"START\");\n  }\n\n  async function nextQuestion() {\n    await addQuestion(game, setGameState);\n    console.debug(\"SKIP QUESTION\");\n  }\n\n  function answer(element) {\n    game.questions[0].choice = Number(element.target.value);\n    game.questions[0].end = Date.now();\n    setGameState({ ...game });\n\n    nextQuestionTimeout = setTimeout(nextQuestion, 3000);\n\n    console.debug(\"ANSWER\");\n  }\n\n  function end(isDuringQuestion = true) {\n    game.end = Date.now();\n\n    if (isDuringQuestion) {\n      game.questions.shift();\n    } else {\n      clearTimeout(nextQuestionTimeout);\n    }\n\n    const stats = collectStats(game);\n    setStatsState(stats);\n\n    game.start = undefined;\n    setGameState({ ...game });\n\n    console.debug(\"END\");\n  }\n\n  return render();\n}\n\nexport default App;\n","import {playIntervalQuestion} from \"./engine\";\nimport React from \"react\";\n\nexport const QuestionsForm = ({answer, question, nextQuestion, end}) => (\n  <section className=\"question\">\n    <header>What is the interval?</header>\n\n    <section className=\"choice\">\n      <button value={0} onClick={answer} disabled={!question.hasPlayed}>1</button>\n      <button value={1} onClick={answer} disabled={!question.hasPlayed}>2</button>\n      <button value={2} onClick={answer} disabled={!question.hasPlayed}>3</button>\n      <button value={3} onClick={answer} disabled={!question.hasPlayed}>4</button>\n      <button value={4} onClick={answer} disabled={!question.hasPlayed}>5</button>\n      <button value={5} onClick={answer} disabled={!question.hasPlayed}>6</button>\n      <button value={6} onClick={answer} disabled={!question.hasPlayed}>7</button>\n      <button value={7} onClick={answer} disabled={!question.hasPlayed}>8</button>\n    </section>\n\n    <section className=\"other-actions\">\n      <button onClick={() => playIntervalQuestion(question)} disabled={!question.hasPlayed}>\n        Re-play\n      </button>\n\n      <button onClick={nextQuestion} disabled={!question.hasPlayed}>\n        Next!\n      </button>\n\n      <button onClick={end} disabled={!question.hasPlayed}>\n        Enough! Show how well I did\n      </button>\n    </section>\n  </section>\n);\n","import React from \"react\";\n\nexport const ChoiceFeedback = ({ isChoiceCorrect, question, end }) => (\n  <section className=\"choice-feedback\">\n    <p>{isChoiceCorrect ? \"CORRECT! 🎉\" : \"Incorrect... 😨\"}</p>\n\n    {!isChoiceCorrect && (\n      <p>\n        You chose {question.choice + 1} but the write interval is{\" \"}\n        <strong>{question.interval.number + 1}</strong>\n      </p>\n    )}\n\n    <p>\n      <strong>But what about this one?</strong>\n    </p>\n\n    <p>\n      <button onClick={() => end(false)}>\n        No more questions, show me stats\n      </button>\n    </p>\n  </section>\n);\n","import { formatTime } from \"./engine\";\nimport React from \"react\";\n\nexport const EndFeedbackWithStats = ({ stats, historicalStats }) => (\n  <section className=\"end\">\n    <div className=\"stats\">\n      {stats.totalQuestions > 0 && (\n        <>\n          <table>\n            <tbody>\n              <tr>\n                <td>\n                  <strong>Total questions</strong>\n                </td>\n                <td>{stats.totalQuestions}</td>\n              </tr>\n              <tr>\n                <td>\n                  <strong>Correct</strong>\n                </td>\n                <td>{stats.totalCorrect}</td>\n              </tr>\n              <tr>\n                <td>\n                  <strong>Incorrect</strong>\n                </td>\n                <td>{stats.totalIncorrect}</td>\n              </tr>\n              <tr>\n                <td>\n                  <strong>Faster hit</strong>\n                </td>\n                <td>\n                  {formatTime(stats.fasterHit?.time)}{\" \"}\n                  {stats.fasterHit.isRecord ? (\n                    <strong> RECORD!</strong>\n                  ) : (\n                    <span>\n                      (Last record: {stats.fasterHit?.lastRecord?.time || \"???\"}{\" \"}\n                      at {String(new Date(stats.fasterHit?.lastRecord?.start))})\n                    </span>\n                  )}\n                </td>\n              </tr>\n              <tr>\n                <td>\n                  <strong>Slower hit</strong>\n                </td>\n                <td>\n                  {formatTime(stats.slowerHit?.time)}{\" \"}\n                  {stats.slowerHit.isRecord ? (\n                    <strong> RECORD!</strong>\n                  ) : (\n                    <span>\n                      (Last record: {stats.slowerHit?.lastRecord?.time || \"???\"}{\" \"}\n                      at {String(new Date(stats.slowerHit?.lastRecord?.start))})\n                    </span>\n                  )}\n                </td>\n              </tr>\n              <tr>\n                <td>\n                  <strong>Avg time to hit</strong>\n                </td>\n                <td>\n                  {formatTime(stats.avgHit?.time)}{\" \"}\n                  {stats.avgHit.isRecord ? (\n                    <strong> RECORD!</strong>\n                  ) : (\n                    <span>\n                      (Last record: {stats.avgHit?.lastRecord?.time || \"???\"} at{\" \"}\n                      {String(new Date(stats.avgHit?.lastRecord?.start))})\n                    </span>\n                  )}\n                </td>\n              </tr>\n              <tr>\n                <td>\n                  <strong>Total elapsed time</strong>\n                </td>\n                <td>{formatTime(stats.totalTime)}</td>\n              </tr>\n            </tbody>\n          </table>\n        </>\n      )}\n    </div>\n  </section>\n);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}